
R version 4.4.1 (2024-06-14) -- "Race for Your Life"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # This file is part of the standard setup for testthat.
> # It is recommended that you do not modify it.
> #
> # Where should you do additional test configuration?
> # Learn more about the roles of various files in:
> # * https://r-pkgs.org/testing-design.html#sec-tests-files-overview
> # * https://testthat.r-lib.org/articles/special-files.html
> 
> library(testthat)
> library(clustOpt)
> 
> test_check("clustOpt")
Loading required package: SeuratObject
Loading required package: sp

Attaching package: 'SeuratObject'

The following objects are masked from 'package:base':

    intersect, t


Attaching package: 'dplyr'

The following object is masked from 'package:testthat':

    matches

The following objects are masked from 'package:stats':

    filter, lag

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union

Input is small enough to run with all cells
Using 10 subject(s) that have at least 50 cells:
JP_RIK_H073 (100 cells)
JP_RIK_H131 (83 cells)
KR_SGI_H002 (76 cells)
KR_SGI_H136 (127 cells)
SG_HEL_H09a (52 cells)
SG_HEL_H077 (147 cells)
SG_HEL_H138 (130 cells)
SG_HEL_H153 (85 cells)
SG_HEL_H166 (123 cells)
SG_HEL_H319 (77 cells)
Found 20 combinations of test subject and resolution
Holdout subject: JP_RIK_H073
Found 2932 (97.73%) shared genes used for projecting test data
Holdout subject: JP_RIK_H131
Found 2923 (97.43%) shared genes used for projecting test data
Holdout subject: KR_SGI_H002
Found 2923 (97.43%) shared genes used for projecting test data
Holdout subject: KR_SGI_H136
Found 2942 (98.07%) shared genes used for projecting test data
Holdout subject: SG_HEL_H09a
Found 2820 (94.00%) shared genes used for projecting test data
Holdout subject: SG_HEL_H077
Found 2988 (99.60%) shared genes used for projecting test data
Holdout subject: SG_HEL_H138
Found 2956 (98.53%) shared genes used for projecting test data
Holdout subject: SG_HEL_H153
Found 2922 (97.40%) shared genes used for projecting test data
Holdout subject: SG_HEL_H166
Found 2956 (98.53%) shared genes used for projecting test data
Holdout subject: SG_HEL_H319
Found 2896 (96.53%) shared genes used for projecting test data

Removing previously calculated leverage scores...
Warning: Matrix compression performs poorly with non-integers.
* Consider calling convert_matrix_type if a compressed integer matrix is intended.
This message is displayed once every 8 hours.
Normalizing layer: counts
Finding variable features for layer counts
Calcuating Leverage Score
Attempting to cast layer counts to dgCMatrix
Attempting to cast layer data to dgCMatrix
Renaming default assay from sketch to RNA

Checking counts matrix class: dgCMatrix 
Performing log-normalization
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Centering and scaling data matrix
  |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
[ FAIL 0 | WARN 5 | SKIP 0 | PASS 21 ]

[ FAIL 0 | WARN 5 | SKIP 0 | PASS 21 ]
> 
> proc.time()
   user  system elapsed 
 48.137   2.232  51.969 
