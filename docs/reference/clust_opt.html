<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>clust_opt — clust_opt • clustOpt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="clust_opt — clust_opt"><meta name="description" content="Runs the main resolution optimization algorithm"><meta property="og:description" content="Runs the main resolution optimization algorithm"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clustOpt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gladstone-institutes/clustOpt" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>clust_opt</h1>
      <small class="dont-index">Source: <a href="https://github.com/gladstone-institutes/clustOpt/blob/HEAD/R/clustOpt.R" class="external-link"><code>R/clustOpt.R</code></a></small>
      <div class="d-none name"><code>clust_opt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Runs the main resolution optimization algorithm</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clust_opt</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  <span class="va">ndim</span>,</span>
<span>  dtype <span class="op">=</span> <span class="st">"scRNA"</span>,</span>
<span>  sketch_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  skip_sketch <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">subject_ids</span>,</span>
<span>  res_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.06</span>, <span class="fl">0.08</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  within_batch <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_trees <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  train_with <span class="op">=</span> <span class="st">"even"</span>,</span>
<span>  min_cells <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>Seurat object</p></dd>


<dt id="arg-ndim">ndim<a class="anchor" aria-label="anchor" href="#arg-ndim"></a></dt>
<dd><p>Number of principal components to use.</p></dd>


<dt id="arg-dtype">dtype<a class="anchor" aria-label="anchor" href="#arg-dtype"></a></dt>
<dd><p>Type of data in the Seurat object "scRNA" or "CyTOF", default
is "scRNA". CyTOF data is expected to be arcsinh normalized (in the counts
slot). Sketching is supported for both data types.</p></dd>


<dt id="arg-sketch-size">sketch_size<a class="anchor" aria-label="anchor" href="#arg-sketch-size"></a></dt>
<dd><p>Number of cells to use for sketching.</p></dd>


<dt id="arg-skip-sketch">skip_sketch<a class="anchor" aria-label="anchor" href="#arg-skip-sketch"></a></dt>
<dd><p>Skip sketching, by default any input with more than
200,000 cells is sketched to 10% of the cells.</p></dd>


<dt id="arg-subject-ids">subject_ids<a class="anchor" aria-label="anchor" href="#arg-subject-ids"></a></dt>
<dd><p>Metadata field that identifies unique subjects.</p></dd>


<dt id="arg-res-range">res_range<a class="anchor" aria-label="anchor" href="#arg-res-range"></a></dt>
<dd><p>Range of resolutions to test.</p></dd>


<dt id="arg-within-batch">within_batch<a class="anchor" aria-label="anchor" href="#arg-within-batch"></a></dt>
<dd><p>Batch variable, for a given sample only those with the
same value for the batch variable will be used for training.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Output messages.</p></dd>


<dt id="arg-num-trees">num_trees<a class="anchor" aria-label="anchor" href="#arg-num-trees"></a></dt>
<dd><p>Number of trees to use in the random forest.</p></dd>


<dt id="arg-train-with">train_with<a class="anchor" aria-label="anchor" href="#arg-train-with"></a></dt>
<dd><p>Either "odd" or "even" PCs for clustering and training.
Default is "even". It is recommended to keep train_with set to "even" so
that the 1st PC is in the set used to calculate silhouette scores.</p></dd>


<dt id="arg-min-cells">min_cells<a class="anchor" aria-label="anchor" href="#arg-min-cells"></a></dt>
<dd><p>Minimum cells per subject, default is 50</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame containing a distribution of silhouette scores for each
resolution.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The clustOpt algorithm works by:</p><ol><li><p>Sketching large datasets using leverage score-based sampling (if needed)</p></li>
<li><p>Splitting principal components into independent odd/even spaces</p></li>
<li><p>Performing subject-wise cross-validation</p></li>
<li><p>Training random forests on cluster assignments</p></li>
<li><p>Evaluating clustering quality using silhouette scores</p></li>
</ol><p>Both scRNA-seq and CyTOF data types support sketching for improved performance
on large datasets. For CyTOF data, normalization is skipped as data should
already be arcsinh transformed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic usage with scRNA-seq data</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">clust_opt</span><span class="op">(</span><span class="va">seurat_obj</span>, ndim <span class="op">=</span> <span class="fl">50</span>, subject_ids <span class="op">=</span> <span class="st">"donor_id"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CyTOF data analysis</span></span></span>
<span class="r-in"><span><span class="va">cytof_results</span> <span class="op">&lt;-</span> <span class="fu">clust_opt</span><span class="op">(</span><span class="va">cytof_obj</span>,</span></span>
<span class="r-in"><span>  ndim <span class="op">=</span> <span class="fl">30</span>, dtype <span class="op">=</span> <span class="st">"CyTOF"</span>,</span></span>
<span class="r-in"><span>  subject_ids <span class="op">=</span> <span class="st">"sample_id"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Large dataset with custom sketch size</span></span></span>
<span class="r-in"><span><span class="va">large_results</span> <span class="op">&lt;-</span> <span class="fu">clust_opt</span><span class="op">(</span><span class="va">large_obj</span>,</span></span>
<span class="r-in"><span>  ndim <span class="op">=</span> <span class="fl">50</span>, sketch_size <span class="op">=</span> <span class="fl">10000</span>,</span></span>
<span class="r-in"><span>  subject_ids <span class="op">=</span> <span class="st">"donor_id"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Natalie Gill, Min-Gyoung Shin, Ayushi Agrawal, Erwin Perez, Reuben Thomas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

